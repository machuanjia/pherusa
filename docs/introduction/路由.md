# 路由
#### 路由采用react-router插件，该插件对路由定义相对宽松，不利于项目中使用，故对其二次封装。
#### 主导航根据定义的路由生成，有些配置项目在下面说明
#### 对于权限和路由的配置，路由定义分为固定路由和动态路由
#### 路由的拆分以模块划分为独立的文件
#### 所有路由组件采用动态加载

```
#所在文件 src/routes
├── src                               // 代码目录
│   ├── routes                        // 路由
│   │   ├── index.ts                  // 入口文件
│   │   ├── authentication.route.ts   // 认证模块路由
│   │   ├── management.route.ts       // 管理模块路由
│   │   ├── ...                      

```

## 使用

```
interface IRoute {
    path: string
    meta: { 
        key: string;      // 唯一key 
        name: string; 
        isLink?: boolean  // 是否是跳转链接，如果设置为true，则点击后打开新窗口，地址为path
        isHidden:boolean  // 导航是否显示
        className:string  // 样式类
    }
    children?: IRoute[]
}

# 固定路由
const routes = [
    {
        path: '/login',
        meta: {                   
            key: 'Login',         
            name: 'login',
            isHidden: true,
        },
        component: LoginView,
    },
    {
        path: '/',
        exact: true,
        component: DashboardView,
        meta: {
            key: 'Redirect',
            name: 'redirect',
            isHidden: true,
        },
    }
]


# 动态路由【根据权限生成的路由】
const projectRoute = {
    path: '/project',
    component: MainLayout,
    meta: {
        key: 'Project',
        name: '项目与交易',
        className: 'menu',
    },
    children: [
        {
            path: '/project/club',
            component: ProjectClueView,
            meta: {
                key: 'ProjectClue',
                name: '线索',
                className: 'menu',
            },
        },
        {
            path: '/project/report',
            component: ProjectReportView,
            meta: {
                key: 'ProjectReport',
                name: '项目报备',
                className: 'menu',
            },
        },
    ],
}
```

## 封装
```
# 所在文件 src/components/render-route/renderRoutes.tsx

const settings = {
    authPath: '/login',                        // 未登录跳转的页面
    whiteList: ['/login'],                     // 无需鉴权的路由
    token: store.getState()['app']['token'],   // 鉴权值
}

export const renderRoutes = (extraProps = {}, switchProps = {}) => {
    // 根据权限生成路由
    const routes = generateRoutes()
    return routes ? (
        <Switch {...switchProps}>
            {routes.map((route: any, i) => (
                <Route
                    key={route.key || i}
                    path={route.path}
                    exact={route.exact}
                    strict={route.strict}
                    render={props => {
                        if (settings.token) {
                            return <route.component {...props} {...extraProps} route={route} />
                        } else {
                            if (settings.whiteList.indexOf(route.path) !== -1) {
                                return <route.component {...props} {...extraProps} route={route} />
                            }
                            return <Redirect to={{ pathname: settings.authPath, state: { from: props.location } }} />
                        }
                    }}
                />
            ))}
        </Switch>
    ) : null
}

# 待完善

```




